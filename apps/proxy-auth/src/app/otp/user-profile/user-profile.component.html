<div class="container profile-page" [ngClass]="theme === 'dark' ? 'dark-theme' : 'light-theme'">
    <section class="card rounded-lg border border-border bg-card shadow-sm p-6 w-full min-w-0">
        <h2 class="m-0 mb-4 text-xl font-semibold tracking-tight text">User Details</h2>
        <form [formGroup]="clientForm" class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
            <mat-form-field appearance="outline">
                <mat-label>Name</mat-label>
                <input matInput formControlName="name" placeholder="Enter your name" disabled class="input-field" />
                <mat-error *ngIf="clientForm.get('name')?.hasError('required')"> Name is required. </mat-error>
                <mat-error *ngIf="clientForm.get('name')?.hasError('pattern')"> Invalid name format. </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Mobile</mat-label>
                <input
                    matInput
                    formControlName="mobile"
                    placeholder="Enter your mobile number"
                    class="input-field input-field--disabled"
                />
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Email</mat-label>
                <input
                    matInput
                    formControlName="email"
                    placeholder="Enter your email"
                    class="input-field input-field--disabled"
                />
            </mat-form-field>
        </form>
        <button type="button" mat-flat-button (click)="updateUser()" color="primary" class="mt-2">Update</button>
        <p *ngIf="update$ | async" class="mt-2 text-sm text-success">Information successfully updated</p>
        <p *ngIf="(error$ | async) || errorMessage" class="mt-2 text-sm text-error">Something went wrong</p>
    </section>

    <section class="card rounded-lg border border-border bg-card shadow-sm p-6 w-full min-w-0">
        <h2 class="m-0 mb-4 text-xl font-semibold tracking-tight text">Organization Details</h2>
        <p class="m-0 mb-2 text-sm text-muted">A list of organizations in your account.</p>
        <div class="profile-table-wrap">
            <table mat-table [dataSource]="(userDetails$ | async)?.c_companies" class="profile-table mat-elevation-z8">
                <ng-container matColumnDef="companyName">
                    <th mat-header-cell *matHeaderCellDef>Organization Name</th>
                    <td mat-cell *matCellDef="let element">{{ element.name }}</td>
                </ng-container>
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef>Action</th>
                    <td mat-cell *matCellDef="let element">
                        <span
                            *ngIf="this.companyDetails?.currentCompany?.company_uname === element.company_uname"
                            class="profile-table__current"
                        >
                            Current Organization
                        </span>
                        <span
                            *ngIf="this.companyDetails?.currentCompany?.company_uname !== element.company_uname"
                            class="profile-table__leave"
                            (click)="openModal(element?.id)"
                        >
                            Leave
                        </span>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
        </div>
        <p class="mt-2 text-sm text-muted" *ngIf="!(userDetails$ | async)?.c_companies">
            Nothing Here, There are no companies to show
        </p>
    </section>
</div>
