<ng-container>
    <div class="dialog-header">
        <div class="heading">Register</div>
    </div>
    <div class="otp-verification-content">
        <div
            class="form-wrapper"
            [formGroup]="registrationForm"
            proxyMarkAllAsTouched
            [buttonRef]="submitBtn"
            (valid)="submit()"
        >
            <p class="subheading">User Details</p>
            <div class="one-line">
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        label: 'First Name',
                        patternError: 'Only alphabets are allowed',
                        formControl: registrationForm.get('user.firstName')
                    }"
                ></ng-container>
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        label: 'Last Name',
                        patternError: 'Only alphabets are allowed',
                        formControl: registrationForm.get('user.lastName')
                    }"
                ></ng-container>
            </div>
            <div class="one-line">
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        key: 'user',
                        label: 'Mobile',
                        required: true,
                        formControl: registrationForm.get('user.mobile')
                    }"
                ></ng-container>
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        label: 'Email',
                        formControl: registrationForm.get('user.email')
                    }"
                ></ng-container>
            </div>

            <ng-container
                [ngTemplateOutlet]="formField"
                [ngTemplateOutletContext]="{
                    key: 'user Name',
                    label: 'user name',
                    required: true,
                    formControl: registrationForm.get('user.username')
                }"
            ></ng-container>
            <div class="one-line">
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        type: 'text',
                        label: 'Password',
                        patternError: 'Enter a valid password',
                        formControl: registrationForm.get('user.password')
                    }"
                ></ng-container>
                <ng-container
                    [ngTemplateOutlet]="formField"
                    [ngTemplateOutletContext]="{
                        type: 'password',
                        label: 'Confirm Password',
                        patternError: 'Enter a valid password',
                        formControl: registrationForm.get('user.confirmPassword')
                    }"
                ></ng-container>
            </div>
            <div class="note">
                <span class="subheading">Note: </span>
                Password should contain atleast one Capital Letter, one Small Letter, one Digit and one Symbol
            </div>
            <div class="one-line submit-wrapper">
                <div class="error-message">
                    <ng-container *ngIf="apiError | async as apiError">
                        <span class="subheading">Error: </span>
                        <span *ngFor="let error of apiError">
                            {{ error }}
                            <br />
                        </span>
                    </ng-container>
                </div>
                <div class="submit-btn">
                    <button #submitBtn mat-flat-button color="primary" (click)="submit()">Submit</button>
                </div>
            </div>
        </div>
    </div>
</ng-container>

<ng-template
    #formField
    let-type="type"
    let-label="label"
    let-hint="hint"
    let-formControl="formControl"
    let-patternError="patternError"
>
    <mat-form-field appearance="outline" style="width: 100%">
        <mat-label>{{ label }} </mat-label>
        <input
            matInput
            autocomplete="off"
            [attr.type]="type ?? 'text'"
            [formControl]="formControl"
            [placeholder]="'Enter ' + label"
        />
        <mat-error *ngIf="formControl.touched">
            <mat-error *ngIf="formControl.errors?.required"> {{ label }} is required. </mat-error>
            <mat-error *ngIf="formControl.errors?.minlengthWithSpace"> Min required length is 3 </mat-error>
            <mat-error *ngIf="formControl.errors?.noStartEndSpaces"> Start and End spaces are not allowed</mat-error>
            <mat-error *ngIf="formControl.errors?.min as minError">
                Min value required is {{ minError?.min }}
            </mat-error>
            <mat-error *ngIf="formControl.errors?.max as maxError">
                Max value allowed is {{ maxError?.max }}
            </mat-error>
            <mat-error *ngIf="formControl.errors?.minlength as minLengthError">
                Min required length is {{ minLengthError?.requiredLength }}
            </mat-error>
            <mat-error *ngIf="formControl.errors?.maxlength as maxLengthError">
                Max allowed length is {{ maxLengthError?.requiredLength }}
            </mat-error>
            <mat-error *ngIf="formControl.errors?.pattern">
                {{ patternError ? patternError : 'Enter valid ' + label }}
            </mat-error>
            <mat-error *ngIf="formControl.errors?.valueSameAsControl"> {{ label }} mismatch </mat-error>
        </mat-error>
        <mat-hint *ngIf="hint">{{ hint }}</mat-hint>
    </mat-form-field>
</ng-template>
